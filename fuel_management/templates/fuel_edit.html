{% extends "base.html" %}

{% block content %}
<style>
    /* ---- same CSS you already use ---- */
    *{margin:0;padding:0;box-sizing:border-box}
    .fuel-entry-container{font-family:Arial,Helvetica,sans-serif;background:#f5f5f5;padding:20px;line-height:1.6}
    .container{max-width:900px;margin:0 auto;background:#fff;border-radius:4px;box-shadow:0 2px 4px rgba(0,0,0,.1)}
    .header{background:#2c3e50;color:#fff;padding:20px 30px;border-radius:4px 4px 0 0}
    .header h1{font-size:1.5em;font-weight:400}
    .messages{margin:20px 30px}
    .alert{padding:12px 20px;border-radius:4px;margin-bottom:10px}
    .alert-success{background:#d4edda;color:#155724;border:1px solid #c3e6cb}
    .alert-error{background:#f8d7da;color:#721c24;border:1px solid #f5c6cb}
    .form-container{padding:30px}
    .section{margin-bottom:30px;padding-bottom:25px;border-bottom:1px solid #e0e0e0}
    .section:last-of-type{border-bottom:none}
    .section-title{font-size:1.1em;color:#2c3e50;margin-bottom:20px;font-weight:600;text-transform:uppercase;letter-spacing:.5px}
    .form-row{display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:20px;margin-bottom:15px}
    .form-group{display:flex;flex-direction:column}
    .form-group label{font-weight:600;color:#555;margin-bottom:6px;font-size:.9em}
    .form-group input,.form-group select{padding:10px 12px;border:1px solid #ccc;border-radius:3px;font-size:.95em;font-family:Arial,Helvetica,sans-serif}
    .form-group input:focus,.form-group select:focus{outline:none;border-color:#2c3e50}
    .form-group select{cursor:pointer;background:#fff}
    .full-width{grid-column:1/-1}
    .btn-container{display:flex;gap:10px;justify-content:flex-end;margin-top:30px;padding-top:20px;border-top:1px solid #e0e0e0}
    .btn{padding:10px 25px;border:none;border-radius:3px;font-size:.95em;cursor:pointer;font-weight:500;text-decoration:none;display:inline-block}
    .btn-primary{background:#2c3e50;color:#fff}
    .btn-primary:hover{background:#34495e}
    .btn-secondary{background:#95a5a6;color:#fff}
    .btn-secondary:hover{background:#7f8c8d}
    @media(max-width:768px){.form-container{padding:20px}.form-row{grid-template-columns:1fr}}
</style>

<div class="fuel-entry-container">
  <div class="container">
    <div class="header"><h1>Edit Fuel Entry</h1></div>

    {% if messages %}
      <div class="messages">
        {% for m in messages %}
          <div class="alert alert-{{ m.tags }}">{{ m }}</div>
        {% endfor %}
      </div>
    {% endif %}

    <div class="form-container">
      <form method="POST" action="{% url 'fuel_edit' record.id %}">
        {% csrf_token %}

        <!-- Vehicle Section -->
        <div class="section">
          <h2 class="section-title">Vehicle Details</h2>
          <div class="form-row">
            <div class="form-group">
              <label for="vehicle_type">Vehicle Type *</label>
              <select id="vehicle_type" name="vehicle_type" required>
                <option value="">Select Type</option>
                <option value="Towwheeler"  {% if record.vehicle_type == "Towwheeler"  %}selected{% endif %}>Two Wheeler</option>
                <option value="fourwheeler" {% if record.vehicle_type == "fourwheeler" %}selected{% endif %}>Four Wheeler</option>
              </select>
            </div>
          </div>
        </div>

        <!-- Driver Section -->
        <div class="section">
          <h2 class="section-title">Driver Details</h2>
          <div class="form-row">
            <div class="form-group">
              <label for="staff_name">Staff/Driver Name *</label>
              <select id="staff_name" name="staff_name" required>
                <option value="">Select Staff</option>
                {% for opt in staff_list %}
                  <option value="{{ opt }}" {% if record.staff_name == opt %}selected{% endif %}>{{ opt }}</option>
                {% endfor %}
              </select>
            </div>
            <div class="form-group">
              <label for="date">Date *</label>
              <input type="date" id="date" name="date" value="{{ record.date|date:'Y-m-d' }}" required>
            </div>
          </div>
        </div>

        <!-- Fuel & Trip Section -->
        <div class="section">
          <h2 class="section-title">Fuel & Trip Details</h2>
          <div class="form-row">
            <div class="form-group">
              <label for="odo_start">Odometer Start (km) *</label>
              <input type="number" id="odo_start" name="odo_start" step="0.01" value="{{ record.odo_start }}" required>
            </div>
            <div class="form-group">
              <label for="odo_end">Odometer End (km) *</label>
              <input type="number" id="odo_end" name="odo_end" step="0.01" value="{{ record.odo_end }}" required>
            </div>
          </div>
          <div class="form-row">
            <div class="form-group">
              <label for="trip_from">Trip From *</label>
              <input type="text" id="trip_from" name="trip_from" value="{{ record.trip_from }}" required>
            </div>
            <div class="form-group">
              <label for="trip_to">Trip To *</label>
              <input type="text" id="trip_to" name="trip_to" value="{{ record.trip_to }}" required>
            </div>
          </div>
          <div class="form-row">
            <div class="form-group">
              <label for="fuel_cost">Fuel Cost (â‚¹) *</label>
              <input type="number" id="fuel_cost" name="fuel_cost" step="0.01" value="{{ record.fuel_cost }}" required>
            </div>
          </div>
        </div>

        <div class="btn-container">
          <a href="{% url 'fuel_management' %}" class="btn btn-secondary">Cancel</a>
          <button type="submit" class="btn btn-primary">Update</button>
        </div>
      </form>
    </div>
  </div>
</div>

<script>
  const odoStart = document.getElementById('odo_start');
  const odoEnd   = document.getElementById('odo_end');
  function calculateDistance() {
    const start = parseFloat(odoStart.value) || 0;
    const end   = parseFloat(odoEnd.value)   || 0;
    if (end < start && end > 0) {
      alert('Odometer end reading cannot be less than start reading!');
      odoEnd.value = '';
    }
  }
  odoEnd.addEventListener('change', calculateDistance);
</script>
{% endblock %}