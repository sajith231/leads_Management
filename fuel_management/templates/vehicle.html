{% extends "base.html" %}

{% block content %}
<style>
    *{box-sizing:border-box;margin:0;padding:0}
    .vehicle-container{font-family:Segoe UI,Helvetica,Arial,sans-serif;background:#f5f5f5;padding:20px}
    .card{max-width:600px;margin:auto;background:#fff;padding:30px;border-radius:10px;box-shadow:0 2px 10px rgba(0,0,0,.1)}
    .card h1{text-align:center;margin-bottom:25px;color:#333}
    .grp{margin-bottom:20px}
    .grp label{display:block;margin-bottom:6px;font-weight:600;color:#555}
    input[type=text],input[type=file],input[type=number],select{width:100%;padding:12px;border:2px solid #ddd;border-radius:6px;font-size:16px}
    input[type=text]:focus,input[type=file]:focus,input[type=number]:focus,select:focus{outline:none;border-color:#4caf50}
    .upload-area{background:#fafafa;border:2px dashed #ccc;border-radius:8px;padding:20px;margin:25px 0}
    .upload-area h3{text-align:center;margin-bottom:15px;color:#333}
    .file-grp{margin-bottom:15px}
    .optional{color:#666;font-weight:normal;font-size:14px}
    .btn{background:#4caf50;color:#fff;padding:14px 0;border:none;border-radius:6px;font-size:18px;width:100%;cursor:pointer;transition:.3s}
    .btn:hover{background:#45a049}
    .rate-display{background:#e9f7ef;padding:10px;border-radius:4px;margin-top:8px;font-weight:600;color:#2c5aa0}
    .alert{margin-bottom:20px;padding:12px;border-radius:6px}
    .alert-error{background:#f8d7da;color:#721c24;border:1px solid #f5c6cb}
    .alert-success{background:#d1edff;color:#155724;border:1px solid #c3e6cb}
</style>

<div class="vehicle-container">
    <div class="card">
        <h1>Vehicle Registration</h1>
        
        <!-- Display Messages -->
        {% if messages %}
            {% for message in messages %}
                <div class="alert {% if message.tags == 'error' %}alert-error{% else %}alert-success{% endif %}">
                    {{ message }}
                </div>
            {% endfor %}
        {% endif %}

        <form method="post" enctype="multipart/form-data">
            {% csrf_token %}
            <div class="grp">
                <label>Vehicle Number</label>
                <input type="text" name="vehicle_number" value="{{ vehicle_number|default:'' }}" required>
            </div>
            <div class="grp">
                <label>Owner Name</label>
                <input type="text" name="owner_name" value="{{ owner_name|default:'' }}" required>
            </div>
            <div class="grp">
                <label>Fuel Type</label>
                <select name="fuel_type" id="fuel_type" required onchange="updateFuelRate()">
                    <option value="petrol" {% if fuel_type == 'petrol' %}selected{% endif %}>Petrol</option>
                    <option value="diesel" {% if fuel_type == 'diesel' %}selected{% endif %}>Diesel</option>
                </select>
            </div>
            <div class="grp">
                <label>Fuel Rate (₹/liter)</label>
                <input type="number" name="fuel_rate" id="fuel_rate" step="0.01" min="0" value="{{ fuel_rate|default:'106.93' }}" required readonly>
                <div class="rate-display" id="rate_display">
                    Current rate: ₹<span id="rate_value">106.93</span> per liter
                </div>
            </div>
            <div class="grp">
                <label>Average Mileage (km/l)</label>
                <input type="number" name="avg_mileage" step="0.01" min="0" value="{{ avg_mileage|default:'' }}" required>
            </div>

            <div class="upload-area">
                <h3>Required Documents <span class="optional">(Optional)</span></h3>
                <div class="file-grp">
                    <label>RC Copy <span class="optional">- Optional</span></label>
                    <input type="file" name="rc_copy" accept=".pdf,.jpg,.jpeg,.png">
                </div>
                <div class="file-grp">
                    <label>Insurance Copy <span class="optional">- Optional</span></label>
                    <input type="file" name="insurance_copy" accept=".pdf,.jpg,.jpeg,.png">
                </div>
                <div class="file-grp">
                    <label>Pollution Copy <span class="optional">- Optional</span></label>
                    <input type="file" name="pollution_copy" accept=".pdf,.jpg,.jpeg,.png">
                </div>
            </div>

            <button type="submit" class="btn">Submit Vehicle Details</button>
        </form>
    </div>
</div>

<script>
    // Fuel rates
    const fuelRates = {
        'petrol': 106.93,
        'diesel': 95.86
    };

    function updateFuelRate() {
        const fuelType = document.getElementById('fuel_type').value;
        const rate = fuelRates[fuelType];
        
        document.getElementById('fuel_rate').value = rate;
        document.getElementById('rate_value').textContent = rate;
    }

    // Initialize on page load
    document.addEventListener('DOMContentLoaded', function() {
        updateFuelRate();
    });
</script>
{% endblock %}